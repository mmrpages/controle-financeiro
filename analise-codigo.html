<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>An√°lise de C√≥digo - Financeiro 2026</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { 
      font-family: 'Inter', system-ui, sans-serif; 
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 20px;
      min-height: 100vh;
    }
    .container { max-width: 1200px; margin: 0 auto; }
    .header { 
      background: white; 
      padding: 30px; 
      border-radius: 20px; 
      margin-bottom: 30px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
    }
    .header h1 { 
      color: #667eea; 
      font-size: 2rem; 
      margin-bottom: 10px;
    }
    .header p { color: #64748b; }
    
    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    .stat-card {
      background: white;
      padding: 25px;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      text-align: center;
    }
    .stat-number {
      font-size: 2.5rem;
      font-weight: 800;
      margin-bottom: 5px;
    }
    .stat-label {
      color: #64748b;
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .critical { color: #ef4444; }
    .warning { color: #f59e0b; }
    .success { color: #10b981; }
    .info { color: #3b82f6; }
    
    .section {
      background: white;
      padding: 30px;
      border-radius: 20px;
      margin-bottom: 20px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    }
    .section h2 {
      color: #1e293b;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 700;
      text-transform: uppercase;
    }
    .badge-critical { background: #fee2e2; color: #991b1b; }
    .badge-warning { background: #fef3c7; color: #92400e; }
    .badge-success { background: #d1fae5; color: #065f46; }
    .badge-info { background: #dbeafe; color: #1e40af; }
    
    .issue {
      background: #f8fafc;
      border-left: 4px solid #cbd5e1;
      padding: 20px;
      margin-bottom: 15px;
      border-radius: 8px;
      transition: all 0.3s;
    }
    .issue:hover {
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      transform: translateX(5px);
    }
    .issue.critical { border-left-color: #ef4444; }
    .issue.warning { border-left-color: #f59e0b; }
    .issue.success { border-left-color: #10b981; }
    
    .issue h3 {
      color: #1e293b;
      margin-bottom: 10px;
      font-size: 1.1rem;
    }
    .issue p {
      color: #64748b;
      line-height: 1.6;
      margin-bottom: 10px;
    }
    .code-block {
      background: #1e293b;
      color: #e2e8f0;
      padding: 15px;
      border-radius: 8px;
      overflow-x: auto;
      font-family: 'Courier New', monospace;
      font-size: 0.85rem;
      margin-top: 10px;
    }
    .good { color: #10b981; }
    .bad { color: #ef4444; }
    
    .filter-buttons {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    .filter-btn {
      padding: 10px 20px;
      border: 2px solid #e2e8f0;
      background: white;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s;
    }
    .filter-btn:hover { transform: translateY(-2px); }
    .filter-btn.active { border-color: #667eea; background: #667eea; color: white; }
    
    .priority-high { background: #fef2f2 !important; }
    .priority-medium { background: #fffbeb !important; }
    .priority-low { background: #f0fdf4 !important; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üîç An√°lise de C√≥digo - Financeiro 2026</h1>
      <p>Relat√≥rio completo de seguran√ßa, performance e boas pr√°ticas</p>
    </div>

    <div class="stats">
      <div class="stat-card">
        <div class="stat-number critical">üî¥ 3</div>
        <div class="stat-label">Cr√≠ticos</div>
      </div>
      <div class="stat-card">
        <div class="stat-number warning">üü° 5</div>
        <div class="stat-label">Avisos</div>
      </div>
      <div class="stat-card">
        <div class="stat-number success">üü¢ 4</div>
        <div class="stat-label">Melhorias</div>
      </div>
      <div class="stat-card">
        <div class="stat-number info">‚ú® 6</div>
        <div class="stat-label">Sugest√µes</div>
      </div>
    </div>

    <div class="filter-buttons">
      <button class="filter-btn active" onclick="filterIssues('all')">Todos</button>
      <button class="filter-btn" onclick="filterIssues('critical')">üî¥ Cr√≠ticos</button>
      <button class="filter-btn" onclick="filterIssues('warning')">üü° Avisos</button>
      <button class="filter-btn" onclick="filterIssues('success')">üü¢ Melhorias</button>
    </div>

    <!-- CR√çTICOS -->
    <div class="section">
      <h2><span class="badge badge-critical">Cr√≠tico</span> Problemas de Seguran√ßa</h2>
      
      <div class="issue critical priority-high" data-type="critical">
        <h3>üö® Chave API do Firebase Exposta no C√≥digo</h3>
        <p><strong>Gravidade:</strong> CR√çTICA | <strong>Arquivo:</strong> config.js</p>
        <p>Suas credenciais do Firebase est√£o expostas no c√≥digo-fonte. Qualquer pessoa que acessar esse arquivo pode usar sua conta do Firebase!</p>
        <div class="code-block">
<span class="bad">// ‚ùå MAL - Chaves expostas</span>
const firebaseConfig = {
  apiKey: "AIzaSyCEhMZcmsklTArvDk2AMDg3Vm6RxzE2a8c",
  authDomain: "mmrpages-controle-financeiro.firebaseapp.com",
  // ...
};

<span class="good">// ‚úÖ BOM - Use vari√°veis de ambiente</span>
const firebaseConfig = {
  apiKey: process.env.FIREBASE_API_KEY,
  authDomain: process.env.FIREBASE_AUTH_DOMAIN,
  // ...
};
        </div>
        <p><strong>Solu√ß√£o:</strong></p>
        <ul style="margin-left: 20px; color: #64748b;">
          <li>Configure regras de seguran√ßa no Firebase Console</li>
          <li>Use vari√°veis de ambiente (.env) para produ√ß√£o</li>
          <li>Adicione restri√ß√µes de dom√≠nio nas configura√ß√µes do Firebase</li>
        </ul>
      </div>

      <div class="issue critical priority-high" data-type="critical">
        <h3>üîê Falta de Valida√ß√£o de Dados</h3>
        <p><strong>Gravidade:</strong> CR√çTICA | <strong>Arquivo:</strong> script.js</p>
        <p>N√£o h√° valida√ß√£o adequada dos dados inseridos pelo usu√°rio, o que pode causar bugs e vulnerabilidades.</p>
        <div class="code-block">
<span class="bad">// ‚ùå MAL - Sem valida√ß√£o</span>
function parseVal(v) {
  return parseFloat(v.toString().replace(/[R$\s.]/g, '').replace(',', '.')) || 0;
}

<span class="good">// ‚úÖ BOM - Com valida√ß√£o</span>
function parseVal(v) {
  if (v === null || v === undefined) return 0;
  const cleaned = v.toString().trim().replace(/[R$\s.]/g, '').replace(',', '.');
  const parsed = parseFloat(cleaned);
  return (isNaN(parsed) || parsed < 0) ? 0 : parsed;
}
        </div>
      </div>

      <div class="issue critical priority-high" data-type="critical">
        <h3>‚ö†Ô∏è Encoding UTF-8 Quebrado</h3>
        <p><strong>Gravidade:</strong> CR√çTICA | <strong>Arquivo:</strong> V√°rios</p>
        <p>Caracteres especiais est√£o corrompidos (Finan√É¬ßas, M√É¬™s, N√É¬£o). Isso indica problema de encoding.</p>
        <div class="code-block">
<span class="bad">// ‚ùå Aparece assim no c√≥digo:</span>
Finan√É¬ßas 2026
M√É¬™s
N√É¬£o tem conta?

<span class="good">// ‚úÖ Deveria aparecer:</span>
Finan√ßas 2026
M√™s
N√£o tem conta?
        </div>
        <p><strong>Solu√ß√£o:</strong> Salve todos os arquivos com encoding UTF-8 no seu editor de c√≥digo.</p>
      </div>
    </div>

    <!-- AVISOS -->
    <div class="section">
      <h2><span class="badge badge-warning">Aviso</span> Problemas de Performance e Arquitetura</h2>
      
      <div class="issue warning priority-high" data-type="warning">
        <h3>üêå Duplica√ß√£o de Dados (localStorage + Firebase)</h3>
        <p><strong>Gravidade:</strong> M√âDIA | <strong>Arquivo:</strong> script.js</p>
        <p>Voc√™ est√° salvando os mesmos dados no localStorage E no Firebase. Isso pode causar inconsist√™ncias.</p>
        <div class="code-block">
async function save() {
  <span class="bad">localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); // ‚ùå</span>
  if (window.auth && window.auth.currentUser) {
    await setDoc(doc(window.db, "usuarios", ...), state);
  }
}

<span class="good">// ‚úÖ Escolha UMA fonte de verdade (Firebase)</span>
async function save() {
  if (window.auth && window.auth.currentUser) {
    await setDoc(doc(window.db, "usuarios", ...), state);
  }
}
        </div>
      </div>

      <div class="issue warning priority-medium" data-type="warning">
        <h3>‚ôªÔ∏è Recalculo Excessivo</h3>
        <p><strong>Arquivo:</strong> script.js</p>
        <p>A fun√ß√£o <code>calculate()</code> √© chamada em CADA keystroke, recalculando tudo repetidamente.</p>
        <div class="code-block">
<span class="good">// ‚úÖ Use debounce para otimizar</span>
const debouncedCalculate = debounce(calculate, 300);

// No input:
oninput="debouncedCalculate()"
        </div>
      </div>

      <div class="issue warning priority-medium" data-type="warning">
        <h3>üîÑ Rebuild Completo Desnecess√°rio</h3>
        <p><strong>Arquivo:</strong> script.js</p>
        <p>Toda vez que salva, voc√™ reconstr√≥i a tabela inteira. Para grandes volumes de dados, isso fica lento.</p>
        <p><strong>Sugest√£o:</strong> Use um framework como React ou Vue, ou implemente atualiza√ß√£o seletiva de DOM.</p>
      </div>

      <div class="issue warning priority-low" data-type="warning">
        <h3>üì¶ Chart.js Importado mas N√£o Usado</h3>
        <p><strong>Arquivo:</strong> index.html</p>
        <p>Voc√™ importa Chart.js no HTML, mas n√£o vejo ele sendo usado no c√≥digo.</p>
        <div class="code-block">
<span class="bad">&lt;script src="https://cdn.jsdelivr.net/npm/chart.js"&gt;&lt;/script&gt;</span>

// Remova se n√£o estiver usando, ou implemente gr√°ficos!
        </div>
      </div>

      <div class="issue warning priority-low" data-type="warning">
        <h3>üóëÔ∏è C√≥digo Morto nos Modais</h3>
        <p><strong>Arquivo:</strong> index.html</p>
        <p>Voc√™ tem modais definidos no HTML que parecem n√£o ser usados (chartModal, totalsModal).</p>
      </div>
    </div>

    <!-- MELHORIAS -->
    <div class="section">
      <h2><span class="badge badge-success">Melhorias</span> Boas Pr√°ticas Recomendadas</h2>
      
      <div class="issue success priority-medium" data-type="success">
        <h3>‚ú® Adicione Loading States</h3>
        <p>Mostre feedback visual durante opera√ß√µes ass√≠ncronas (login, salvamento).</p>
        <div class="code-block">
async function save() {
  <span class="good">showLoading(); // ‚úÖ Feedback visual</span>
  try {
    await setDoc(...);
    <span class="good">showSuccess("Salvo com sucesso!");</span>
  } catch (error) {
    <span class="good">showError("Erro ao salvar: " + error.message);</span>
  } finally {
    <span class="good">hideLoading();</span>
  }
}
        </div>
      </div>

      <div class="issue success priority-medium" data-type="success">
        <h3>üéØ Tratamento de Erros Melhorado</h3>
        <p>Adicione try-catch em mais lugares e d√™ feedback ao usu√°rio.</p>
        <div class="code-block">
<span class="bad">// ‚ùå Erro silencioso</span>
async function loadUserData(uid) {
  const docRef = doc(window.db, "usuarios", uid);
  const docSnap = await getDoc(docRef);
  // E se der erro?
}

<span class="good">// ‚úÖ Com tratamento</span>
async function loadUserData(uid) {
  try {
    const docRef = doc(window.db, "usuarios", uid);
    const docSnap = await getDoc(docRef);
    if (docSnap.exists()) {
      window.updateStateFromFirebase(docSnap.data());
    } else {
      console.log("Novo usu√°rio, criando dados...");
    }
  } catch (error) {
    console.error("Erro ao carregar:", error);
    alert("Erro ao carregar seus dados. Tente novamente.");
  }
}
        </div>
      </div>

      <div class="issue success priority-low" data-type="success">
        <h3>üì± Responsividade Mobile</h3>
        <p>A tabela tem <code>min-width: 1300px</code>, o que pode ser ruim em celulares.</p>
        <p><strong>Sugest√£o:</strong> Considere um layout de cards para mobile usando media queries.</p>
      </div>

      <div class="issue success priority-low" data-type="success">
        <h3>üé® Consist√™ncia Visual</h3>
        <p>Alguns estilos est√£o inline no HTML quando poderiam estar no CSS.</p>
        <div class="code-block">
<span class="bad">&lt;button style="color:var(--text-muted)"&gt;</span>

<span class="good">&lt;button class="btn-muted"&gt;</span>
// No CSS:
.btn-muted { color: var(--text-muted); }
        </div>
      </div>
    </div>

    <!-- PONTOS POSITIVOS -->
    <div class="section" style="background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); border: 2px solid #10b981;">
      <h2 style="color: #065f46;">üéâ Pontos Positivos do Seu C√≥digo!</h2>
      
      <div style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 15px;">
        <h3 style="color: #10b981;">‚úÖ Boa Organiza√ß√£o de Arquivos</h3>
        <p>Separa√ß√£o clara entre config, autentica√ß√£o, l√≥gica e estilos.</p>
      </div>

      <div style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 15px;">
        <h3 style="color: #10b981;">‚úÖ Uso de ES6 Modules</h3>
        <p>Voc√™ est√° usando import/export corretamente para modularizar o c√≥digo.</p>
      </div>

      <div style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 15px;">
        <h3 style="color: #10b981;">‚úÖ Design System Consistente</h3>
        <p>Bom uso de CSS variables para manter cores e estilos consistentes.</p>
      </div>

      <div style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 15px;">
        <h3 style="color: #10b981;">‚úÖ Autentica√ß√£o Implementada</h3>
        <p>Sistema de login/cadastro funcionando com Firebase Auth.</p>
      </div>

      <div style="background: white; padding: 20px; border-radius: 12px;">
        <h3 style="color: #10b981;">‚úÖ Interface Limpa e Moderna</h3>
        <p>Design bonito com boa hierarquia visual e UX intuitiva.</p>
      </div>
    </div>

    <!-- PR√ìXIMOS PASSOS -->
    <div class="section" style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); border: 2px solid #3b82f6;">
      <h2 style="color: #1e40af;">üöÄ Pr√≥ximos Passos Recomendados</h2>
      
      <div style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 15px;">
        <h3>1Ô∏è‚É£ Prioridade ALTA</h3>
        <ul style="margin-left: 20px; color: #64748b; line-height: 1.8;">
          <li>Corrigir o encoding UTF-8 dos arquivos</li>
          <li>Configurar regras de seguran√ßa do Firebase</li>
          <li>Adicionar valida√ß√£o de inputs</li>
        </ul>
      </div>

      <div style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 15px;">
        <h3>2Ô∏è‚É£ Prioridade M√âDIA</h3>
        <ul style="margin-left: 20px; color: #64748b; line-height: 1.8;">
          <li>Implementar loading states</li>
          <li>Melhorar tratamento de erros</li>
          <li>Otimizar rec√°lculos com debounce</li>
          <li>Decidir entre localStorage ou Firebase (n√£o ambos)</li>
        </ul>
      </div>

      <div style="background: white; padding: 20px; border-radius: 12px;">
        <h3>3Ô∏è‚É£ Melhorias Futuras</h3>
        <ul style="margin-left: 20px; color: #64748b; line-height: 1.8;">
          <li>Implementar gr√°ficos com Chart.js (j√° est√° importado!)</li>
          <li>Melhorar responsividade mobile</li>
          <li>Adicionar testes unit√°rios</li>
          <li>Considerar migrar para um framework (React/Vue)</li>
        </ul>
      </div>
    </div>

  </div>

  <script>
    function filterIssues(type) {
      const issues = document.querySelectorAll('.issue');
      const buttons = document.querySelectorAll('.filter-btn');
      
      buttons.forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      
      issues.forEach(issue => {
        if (type === 'all') {
          issue.style.display = 'block';
        } else {
          issue.style.display = issue.dataset.type === type ? 'block' : 'none';
        }
      });
    }
  </script>
</body>
</html>